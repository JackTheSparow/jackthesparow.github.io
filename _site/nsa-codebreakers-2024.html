<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NSA Codebreakers 2024 | JackTheSparow</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="NSA Codebreakers 2024" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Task 1" />
<meta property="og:description" content="Task 1" />
<link rel="canonical" href="http://localhost:4000/nsa-codebreakers-2024" />
<meta property="og:url" content="http://localhost:4000/nsa-codebreakers-2024" />
<meta property="og:site_name" content="JackTheSparow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-20T02:38:20-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NSA Codebreakers 2024" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-01-20T02:38:20-05:00","datePublished":"2025-01-20T02:38:20-05:00","description":"Task 1","headline":"NSA Codebreakers 2024","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/nsa-codebreakers-2024"},"url":"http://localhost:4000/nsa-codebreakers-2024"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="JackTheSparow" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">JackTheSparow</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories.html">Categories</a><a class="page-link" href="/contact.html">Contact</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">NSA Codebreakers 2024</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-01-20T02:38:20-05:00" itemprop="datePublished">Jan 20, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h3 id="task-1">Task 1</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span>file shipped.db
</code></pre></div></div>
<ul>
  <li>
    <p>Tried to open with OpenSQLite browser but couldn’t open it. Shows encrypted.</p>
  </li>
  <li>
    <p>Then found out it is not an encrypted file:</p>
  </li>
</ul>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span>fcrackzip <span class="nt">-v</span> <span class="nt">-u</span> <span class="nt">-D</span> <span class="nt">-p</span> /usr/share/wordlists/rockyou.txt shipping.db                         
<span class="go">'mimetype' is not encrypted, skipping
'Configurations2/toolpanel/' is not encrypted, skipping
'Configurations2/progressbar/' is not encrypted, skipping
'Configurations2/statusbar/' is not encrypted, skipping
'Configurations2/toolbar/' is not encrypted, skipping
'Configurations2/floater/' is not encrypted, skipping
'Configurations2/popupmenu/' is not encrypted, skipping
'Configurations2/menubar/' is not encrypted, skipping
'manifest.rdf' is not encrypted, skipping
found id 6ecd93cd, 'shipping.db' is not a zipfile ver 2.xx, skipping
no usable files found
</span></code></pre></div></div>

<ul>
  <li>
    <p>After Unzipping, tried to view content of content.xml: All Gibbrish</p>
  </li>
  <li>Tried to reconstruct it in readable format:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span>zip <span class="nt">-r</span> ../files.odt <span class="k">*</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Word  &amp; Libreoffice don’t show good format, not readable and cannot be analyzed</p>
  </li>
  <li>
    <p>Reconstructing to Sqlite file using python script.</p>
  </li>
  <li>
    <p>Finally reconstructed after trial and error.</p>
  </li>
  <li>Found Guardian Armamenet a suspicious company from Thumbnails.png after Googling all companies names</li>
</ul>

<p>Random Entry for a different addresss at No:899 which is suspicous</p>

<p><strong>Boom Flag</strong></p>

<p><img src="/assets/task1.png" alt="Task 1 Badge" /></p>

<h3 id="task-2">Task 2</h3>

<p>Create ZFS Pool on Ubuntu using following commands:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span>lsblk
<span class="gp">$</span><span class="nb">sudo </span>fallocate <span class="nt">-l</span> 1G /tmp/zfs-disk.img
<span class="gp">$</span><span class="nb">sudo </span>losetup <span class="nt">-fP</span> /tmp/zfs-disk.img
<span class="gp">$</span>losetup <span class="nt">-a</span>
<span class="gp">$</span>lsblk
<span class="gp">$</span><span class="nb">sudo </span>zpool create nkfipool /dev/loop46
<span class="gp">$</span><span class="nb">sudo </span>zfs create nkfipool/rjfs
<span class="gp">$</span>zfs list <span class="nt">-t</span> snapshot
<span class="gp">$</span>zpool list
</code></pre></div></div>

<p>If directory is hidden:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="nb">sudo </span>zfs get snapdir nkfipool/rjfs
<span class="gp">$</span><span class="nb">sudo </span>zfs <span class="nb">set </span><span class="nv">snapdir</span><span class="o">=</span>visible nkfipool/rjfs
<span class="gp">$</span><span class="nb">sudo </span>zfs get snapdir nkfipool/rjfs
</code></pre></div></div>

<p>Info on Pool:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="nb">sudo </span>zdb <span class="nt">-vvv</span> nkfipool/rjfs
</code></pre></div></div>

<p>Manually Recover each Snapshot SEQUENTIALLY using source GUID &amp; Destination GUID:</p>

<p>View GUID:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="k">for </span>f <span class="k">in</span> <span class="k">*</span><span class="p">;</span> <span class="k">do </span>file <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">':'</span> <span class="nt">-f1</span>,4,5 | column <span class="nt">-t</span> <span class="nt">-s</span> <span class="s1">':'</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>zfs receive nkfipool/rjfs <span class="o">&gt;</span> logseq24006643128753-i
</code></pre></div></div>

<p>Check directory of each recovered snapshot: :/nkfipool/rjfs/planning/pages</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go"> contents.md        'Elliptic curve recovery.md'   LLM.md   'token generation.md'  'ZFS snapshots.md'
'CUDA elliptic.md'   golang.md                     todo.md   tools.md
</span></code></pre></div></div>

<p>Do checksum of each file</p>

<p>Write Script to do checksum of each file, then print it:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Base directory where all logseq directories are stored
<span class="go">BASE_DIR="/nkfipool/rjfs/.zfs/snapshot"

</span><span class="gp">#</span><span class="w"> </span>List of logseq directories
<span class="go">LOGSEQ_DIRS=(
    "logseq11079254764090"
    "logseq11652828730004"
    "logseq11865316111135"
    "logseq1275510227140"
    "logseq169607977607"
    "logseq1838778124435"
    "logseq18584850428477"
    "logseq211821980113211"
    "logseq24006643128753"
    "logseq259372600032543"
    "logseq263292687127458"
    "logseq269718728817"
    "logseq27077118912783"
    "logseq30280209123973"
    "logseq307981931423438"
    "logseq4015160425167"
    "logseq73041633518013"
    "logseq77311709316810"
    "logseq81871640320073"
    "logseq98931947620095"
)

</span><span class="gp">#</span><span class="w"> </span>Iterate through each logseq directory
<span class="gp">for logseq_dir in "$</span><span class="o">{</span>LOGSEQ_DIRS[@]<span class="o">}</span><span class="s2">"; do
</span><span class="gp">    #</span><span class="w"> </span><span class="s2">Directory containing files
</span><span class="gp">    PAGES_DIR="$</span><span class="s2">BASE_DIR/</span><span class="nv">$logseq_dir</span><span class="s2">/planning/pages"</span>
<span class="go">    
</span><span class="gp">    #</span><span class="w"> </span>Check <span class="k">if </span>the directory exists
<span class="gp">    if [ -d "$</span>PAGES_DIR<span class="s2">" ]; then
</span><span class="gp">        #</span><span class="s2">echo "</span>Processing files <span class="k">in</span> <span class="nv">$PAGES_DIR</span><span class="s2">"
</span><span class="go">	echo ""
        
</span><span class="gp">        #</span><span class="w"> </span>Iterate through each file <span class="k">in </span>the pages directory
<span class="gp">        for file in "$</span>PAGES_DIR<span class="s2">"/*; do
</span><span class="gp">            if [ -f "$</span><span class="s2">file"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
<span class="gp">                #</span><span class="w"> </span>Print the SHA256 checksum of the file
<span class="gp">                sha256sum "$</span>file<span class="s2">"
</span><span class="go">            fi
        done
    else
</span><span class="gp">        #</span><span class="nb">echo</span> <span class="s2">"Directory </span><span class="nv">$PAGES_DIR</span><span class="s2"> does not exist or is inaccessible."</span>
<span class="go">	echo ""
    fi
done
</span></code></pre></div></div>

<p><strong>Boom You’ve got all checksums</strong></p>

<p><img src="/assets/task2.png" alt="Task 2 Badge" /></p>

  </div><a class="u-url" href="/nsa-codebreakers-2024" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">JackTheSparow</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">JackTheSparow</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Welcome to The Pirates Bay. The website is under development</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
